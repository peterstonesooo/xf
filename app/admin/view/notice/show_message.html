<div class="box">
    <div class="box-header with-border">
        <h3 class="box-title"><?php echo empty($data) ? '添加消息' : '编辑消息'; ?></h3>
    </div>
    <form class="form-horizontal" id="form">
        <div class="box-body">
            <div class="form-group">
                <label class="col-sm-2 control-label">标题</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="title" value="{$data['title']??''}" placeholder="请输入标题">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">类型</label>
                <div class="col-sm-10">
                    <select class="form-control" name="type">
                        <option value="1" <?php if(isset($data['type']) && $data['type'] == 1) echo 'selected'; ?>>系统通知</option>
                        <option value="2" <?php if(isset($data['type']) && $data['type'] == 2) echo 'selected'; ?>>重要公告</option>
                        <option value="3" <?php if(isset($data['type']) && $data['type'] == 3) echo 'selected'; ?>>活动消息</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">内容</label>
                <div class="col-sm-10">
                    <textarea class="form-control" name="content" rows="10" placeholder="请输入内容">{$data['content']??''}</textarea>
                </div>
            </div>
        </div>
        <div class="box-footer">
            <div class="col-sm-offset-2 col-sm-10">
                <button type="button" class="btn btn-primary" onclick="sub()">保存</button>
                <a class="btn btn-default" href="{:url('admin/Notice/messageList')}">返回</a>
            </div>
        </div>
    </form>
</div>

<script>
function sub() {
    var data = $('#form').serialize();
    var url = '<?php echo empty($data) ? url("admin/Notice/addMessage") : url("admin/Notice/editMessage"); ?>';
    <?php if(!empty($data)) { ?>
    data += '&id=<?php echo $data["id"]; ?>';
    <?php } ?>
    
    $.post(url, data, function(res) {
        if(res.code == '200') {
            layer.msg(res.msg, {icon: 1, time: 2000}, function(){
                window.location.href = '<?php echo url("admin/Notice/messageList"); ?>';
            });
        } else {
            layer.msg(res.msg, {icon: 2, time: 2000});
        }
    });
}
</script> 